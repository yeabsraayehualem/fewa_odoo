<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Kanban View -->
    <record id="res_users_view_kanban_custom" model="ir.ui.view">
        <field name="name">res.users.view.kanban.custom</field>
        <field name="model">res.users</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile">
                <field name="id"/>
                <field name="name"/>
                <field name="login"/>
                <field name="image_128"/>
                <field name="user_type"/>
                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_global_click o_kanban_record_has_image_fill">
                            <t t-set="placeholder" t-value="'/base/static/img/avatar_grey.png'"/>
                            <div class="o_kanban_image_fill_left d-none d-md-block" t-attf-style="background-image:url('#{kanban_image('res.users', 'image_128', record.id.raw_value, placeholder)}')"/>
                            <div class="oe_kanban_details">
                                <strong class="o_kanban_record_title">
                                    <field name="name"/>
                                </strong>
                                <div class="o_kanban_record_subtitle">
                                    <field name="login"/>
                                </div>
                                <div>
                                    <span t-if="record.user_type.raw_value" class="badge badge-primary">
                                        <field name="user_type"/>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- List (list) View -->
    <record id="res_users_view_list_custom" model="ir.ui.view">
        <field name="name">res.users.view.list.custom</field>
        <field name="model">res.users</field>
        <field name="arch" type="xml">
            <list string="Users">
                <field name="name"/>
                <field name="login"/>
                <field name="user_type"/>
                <field name="lang"/>
                <field name="login_date"/>
            </list>
        </field>
    </record>

    <!-- Form View -->
    <record id="res_users_view_form_custom" model="ir.ui.view">
        <field name="name">res.users.view.form.custom</field>
        <field name="model">res.users</field>
        <field name="arch" type="xml">
            <form string="User">
                <sheet>
                    <field name="image_1920" widget="image" class="oe_avatar" options="{'preview_image': 'image_128'}"/>
                    <div class="oe_title">
                        <label for="name" class="oe_edit_only"/>
                        <h1>
                            <field name="name" required="1"/>
                        </h1>
                        <label for="login" class="oe_edit_only" string="Email Address"/>
                        <h2>
                            <field name="login"/>
                        </h2>
                        <group>
                            <field name="user_type"/>
                        </group>
                    </div>
                    <notebook>
                        <page string="Access Rights">
                            <group>
                                <field name="groups_id" widget="many2many_tags"/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Action -->
    <record id="action_res_users_custom" model="ir.actions.act_window">
        <field name="name">Fewa Users</field>
        <field name="res_model">res.users</field>
        <field name="view_mode">kanban,list,form</field>
        <field name="domain">[('company_id', 'not in', allowed_company_ids)]</field>
        <field name="context">{'default_user_type': 'employee'}</field>
        <field name="view_ids" eval="[(5, 0, 0),
            (0, 0, {'view_mode': 'kanban', 'view_id': ref('res_users_view_kanban_custom')}),
            (0, 0, {'view_mode': 'list', 'view_id': ref('res_users_view_list_custom')}),
            (0, 0, {'view_mode': 'form', 'view_id': ref('res_users_view_form_custom')})]"/>
    </record>


    <record id="action_res_users_self_employed_custom" model="ir.actions.act_window">
        <field name="name">Fewa Users</field>
        <field name="res_model">res.users</field>
        <field name="view_mode">kanban,list,form</field>
        <field name="domain">[('company_id','in',allowed_company_ids),('user_type','=','self_employed')]</field>
        <field name="view_ids" eval="[(5, 0, 0),
            (0, 0, {'view_mode': 'kanban', 'view_id': ref('res_users_view_kanban_custom')}),
            (0, 0, {'view_mode': 'list', 'view_id': ref('res_users_view_list_custom')}),
            (0, 0, {'view_mode': 'form', 'view_id': ref('res_users_view_form_custom')})]"/>
    </record>


    <menuitem id="fewa_users_menu_menu" name="Customer Users" sequence="70" web_icon="user_type,static/src/img/icon.png" groups="user_type.group_fewa_user" />

    <menuitem id="menu_fewa_users" name="Customer Users" action="action_res_users_custom" parent="fewa_users_menu_menu"/>
    <menuitem id="menu_fewa_self_employed_users" name="Self-Employed" action="action_res_users_self_employed_custom" parent="fewa_users_menu_menu"/>
</odoo>
